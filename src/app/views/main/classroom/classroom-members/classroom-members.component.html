<o-loading [isLoading]="isLoading" />

<div class="container">
  <header class="header">
    <button mat-icon-button class="back-button" [routerLink]="['/i/' + this.ctx.institution?.id + '/c/' + this.ctx.classroom?.id]">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <div class="header-content">
      <div class="title-container">
        <h1 class="title">Membros da turma</h1>
        <span class="subtitle">{{ctx.classroom?.name}} • {{teachers.length}} Professores • {{students.length}} alunos</span>
      </div>
      @if (ctx.isTeacher) {
        <button mat-flat-button class="add-member-button" (click)="addMember()">
          <mat-icon>person_add</mat-icon>
          <span>ADICIONAR MEMBROS</span>
        </button>
      }
    </div>
  </header>

  <div class="content">
    <div class="members-section">
      <div class="section-header">
        <h2 class="section-title">Professores ({{teachers.length}})</h2>
        @if (ctx.isTeacher) {
          <button mat-button class="add-button" (click)="addMember()">
            <mat-icon>add</mat-icon>
            <span>Adicionar Professor</span>
          </button>
        }
      </div>
      <div class="members-list">
        @for (teacher of teachers; track teacher.id) {
          <div class="member-card">
            <div class="member-info">
              <div class="avatar-placeholder">
                <span>{{ teacher.user.name | slice:0:2 }}</span>
              </div>
              <div class="member-details">
                <span class="member-name">{{ teacher.user.name }}</span>
                <span class="member-email">{{ teacher.email }}</span>
              </div>
            </div>
            @if (ctx.isTeacher) {
              <button mat-icon-button class="remove-button" (click)="removeMember(teacher)">
                <mat-icon>close</mat-icon>
              </button>
            }
          </div>
        } @empty {
          <p class="empty-message">Não há professores nesta turma</p>
        }
      </div>
    </div>

    <div class="members-section">
      <div class="section-header">
        <h2 class="section-title">Alunos ({{students.length}})</h2>
        @if (ctx.isTeacher) {
          <button mat-button class="add-button" (click)="addMember()">
            <mat-icon>add</mat-icon>
            <span>Adicionar Aluno</span>
          </button>
        }
      </div>
      <div class="members-list">
        @for (student of students; track student.id) {
          <div class="member-card">
            <div class="member-info">
              <div class="avatar-placeholder">
                <span>{{ student.user.name | slice:0:2 }}</span>
              </div>
              <div class="member-details">
                <span class="member-name">{{ student.user.name }}</span>
                <span class="member-email">{{ student.email }}</span>
              </div>
            </div>
            @if (ctx.isTeacher) {
              <button mat-icon-button class="remove-button" (click)="removeMember(student)">
                <mat-icon>close</mat-icon>
              </button>
            }
          </div>
        } @empty {
          <p class="empty-message">Não há alunos nesta turma</p>
        }
      </div>
    </div>
  </div>
</div>